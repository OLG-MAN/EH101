### Vulnerability Scanning Overview

```
# Scanning is automated and focuses on finding potential/known vulnerabilities on the network or at the application level. 
# Vulnerabilities scanners typically do not exploit vulnerabilities (with some exceptions) but need a human to manually validate scan issues 

# Vulnerability scanning is often part of a standard penetration test, but the two are not the same. 
# A vulnerability scan can help gain additional coverage during a penetration test or speed up the project's testing under time constraints.

# The type of scans run varies from one tool to another, but most tools run a combination of dynamic and static tests, 
# depending on the target and the vulnerability.

# A static test would determine a vulnerability if the identified version of a particular asset has a public CVE. 
# However, this is not always accurate as a patch may have been applied, or the target isn't specifically vulnerable to that CVE. 
# On the other hand, a dynamic test tries specific (usually benign) payloads such as
#  weak credentials, SQL injection, or command injection on the target (i.e., a web application). 
# If any payload returns a hit, then there's a good chance that it is vulnerable.

# Organizations should run both unauthenticated and authenticated scans on a continuous schedule to ensure that assets are patched 
# as new vulnerabilities are discovered and that any new assets added to the network do not have missing patches or other configuration/patching issues.

# Nessus, Nexpose, and Qualys are well-known vulnerability scanning platforms that also provide free community editions. 
# There are also open-source alternatives such as OpenVAS.
```

### Nessus Overview

```
# Nessus Essentials by Tenable is the free version of the official Nessus Vulnerability Scanner. 
# Individuals can access Nessus Essentials to get started understanding Tenable's vulnerability scanner. 
# The caveat is that it can only be used for up to 16 hosts. 

# The features in the free version are limited but are perfect for someone looking to get started with Nessus. 
# The free scanner will attempt to identify vulnerabilities in an environment.
```

### OpenVAS Overview

```
# OpenVAS by Greenbone Networks is a publicly available open-source vulnerability scanner. 
# OpenVAS can perform network scans, including authenticated and unauthenticated testing.
```

### Getting Started with Nessus
[Download page](https://www.tenable.com/downloads/nessus?loginAttempted=true)
[Activation code page](https://www.tenable.com/products/nessus/activation-code)
```
curl --request GET \
--url 'https://www.tenable.com/downloads/api/v2/pages/nessus/files/Nessus-10.8.2-ubuntu1604_amd64.deb' \
--output 'Nessus-10.8.2-ubuntu1604_amd64.deb'

dpkg -i Nessus-8.15.1-ubuntu910_amd64.deb

# To access Nessus, we can navigate to https://localhost:8834. 
# Once we arrive at the setup page, we should select Nessus Essentials for the free version, and then we can enter our activation code.
```

### New Scan

```
# Here we have options for a basic Host Discovery scan to identify live hosts/open ports or a variety of scan types such as 
# the Basic Network Scan, Advanced Scan, Malware Scan, Web Application Tests, 
# as well as scans targeted at specific CVEs and audit & compliance standards.
```

### Discovery

```
# In the Discovery section, under Host Discovery, we're presented with the option to enable scanning for fragile devices. 
# Scanning devices such as network printers often result in them printing out reams of paper with garbage text, leaving the devices unusable.
```

### Assessment
```
# Under the Assessment category, web application scanning can also be enabled if required, 
# and a custom user agent and various other web application scanning options can be specified 
# (e.g., a URL for Remote File Inclusion (RFI) testing)
```

### Scanning with Credentials

```
# Nessus also supports credentialed scanning and provides a lot of flexibility by supporting LM/NTLM hashes, 
# Kerberos authentication, and password authentication.

# Credentials can be configured for host-based authentication via SSH with a password, public key, certificate, or Kerberos-based authentication. 
# It can also be configured for Windows host-based authentication with a password, Kerberos, LM hash, or NTLM hash
```

### Advanced

```
# On the Advanced tab, safe checks are enabled by default. 
# This prevents Nessus from running checks that may negatively impact the target device or network. 
```

### Scan Policies

```
# Nessus gives us the option to create scan policies. 
# Essentially these are customized scans that allow us to define specific scan options, save the policy configuration, 
# and have them available to us under Scan Templates when creating a new scan. 
```

### Nessus Plugins

```
# Nessus works with plugins written in the Nessus Attack Scripting Language (NASL) and can target new vulnerabilities and CVEs. 
# These plugins contain information such as the vulnerability name, impact, remediation, 
# and a way to test for the presence of a particular issue.

# Plugins are rated by severity level: Critical, High, Medium, Low, Info. 
# At the time of this writing Tenable has published 145,973 plugins that cover 58,391 CVE IDs and 30,696 Bugtraq IDs. 
# A searchable database of all published plugins is on the Tenable website.
```
[Tenable website](https://www.tenable.com/plugins)

### In summary 

```
# Nessus essentials app have very friendly UI, and it takes 10-20 min to catch up with 80-90% of options for basic scans etc.
# Other 10% more deep rarely used details. 
```

### Scanning Issues

```
# Scans can cause issues on sensitive networks and provide false positives, no results, or have an unfavorable impact on the network.

# Mitigating Issues

# Some firewalls will cause us to receive scan results showing either all ports open or no ports open. 
# If this happens, a quick fix is often to configure an Advanced Scan and disable the Ping the remote host option. 
# This will stop the scan from using ICMP to verify that the host is "live" and instead proceed with the scan. 

# In sensitive networks, we can use rate-limiting to minimize impact. 
# For example, we can adjust Performance Options and modify Max Concurrent Checks Per Host if the target host is often under heavy load, 
# such as a widely used web application. 
# This will limit the number of plugins used concurrently against the host.

# Network Impact

# It is also essential to keep in mind the potential impact of vulnerability scanning on a network, 
# especially on low bandwidth or congested links. This can be measured using vnstat:

sudo apt install vnstat               # Install 
sudo vnstat -l -i eth0                # Let's monitor the eth0 network adapter before running a Nessus scan

# We can compare this result with the result we get when monitoring the same interface during a Nessus scan against just one host:

# When comparing the results, we can see that the number of bytes and packets transferred during a vulnerability scan is quite significant 
# and can severely impact a network if not tuned properly or performed against fragile/sensitive devices.
```
